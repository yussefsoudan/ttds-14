{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Grid from'@material-ui/core/Grid';import BookCard from\"../components/BookCard.js\";import Pagination from'@material-ui/lab/Pagination';import Switch from'@material-ui/core/Switch';import FormControlLabel from'@material-ui/core/FormControlLabel';import CircularProgress from'@material-ui/core/CircularProgress';import Typography from'@material-ui/core/Typography';//  props will be a list of book objects\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ResultPage(_ref){var results=_ref.results,searchTerms=_ref.searchTerms;var _useState=useState({data:[],searchTerms:[],offset:1,perPageResults:10,sort:false}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];console.log(\"Result page rendered\");useEffect(function(){var onRender=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"Use effect hook\");setState(_objectSpread(_objectSpread({},state),{},{data:results,searchTerms:searchTerms}));case 2:case\"end\":return _context.stop();}}},_callee);}));return function onRender(){return _ref2.apply(this,arguments);};}();onRender();},[]);var handlePaginationClick=function handlePaginationClick(offset){setState(_objectSpread(_objectSpread({},state),{},{offset:offset}));};var handleSort=function handleSort(value){console.log(\"Sort\");var arr=state.data;arr=sortByKey(arr,\"averageRating\");setState(_objectSpread(_objectSpread({},state),{},{sort:value,data:arr,sorting:false}));console.log(\"Sorted results\",state.data);};var sortByKey=function sortByKey(array,key){return array.sort(function(a,b){var x=a[key];var y=b[key];return x<y?1:x>y?-1:0;});};// Calculate how many pagination page we will have \nvar length=Object.keys(state.data).length;var count;if(length%Number(state.perPageResults)==0)count=Math.floor(length/Number(state.perPageResults));else count=Math.floor(length/Number(state.perPageResults))+1;console.log(\"Page count\",count);return/*#__PURE__*/_jsx(Grid,{container:true,className:\"book-container\",spacing:6,justify:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsxs(Grid,{item:true,className:\"book-card-result\",xs:8,children:[length>0&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[length>state.perPageResults&&/*#__PURE__*/_jsx(Grid,{item:true,xs:8,children:/*#__PURE__*/_jsx(Pagination,{count:count,page:state.offset,onChange:function onChange(e,offset){return handlePaginationClick(offset);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:2,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:state.sort,onChange:function onChange(e){return handleSort(e.target.checked);},name:\"sort\",color:\"primary\"}),label:\"Average Rating\",labelPlacement:\"End\"})})]}),state.data.slice((state.offset-1)*state.perPageResults,(state.offset-1)*state.perPageResults+Number(state.perPageResults)).filter(function(book){return book.title!=null;}).map(function(book,idx){return/*#__PURE__*/_jsx(BookCard,{item:true,resultObj:book,searchTerms:state.searchTerms},idx);}),length>state.perPageResults&&/*#__PURE__*/_jsx(Pagination,{count:count,page:state.offset,onChange:function onChange(e,offset){return handlePaginationClick(offset);}})]})});};","map":{"version":3,"sources":["/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/src/views/ResultPage.js"],"names":["React","useState","useEffect","Grid","BookCard","Pagination","Switch","FormControlLabel","CircularProgress","Typography","ResultPage","results","searchTerms","data","offset","perPageResults","sort","state","setState","console","log","onRender","handlePaginationClick","handleSort","value","arr","sortByKey","sorting","array","key","a","b","x","y","length","Object","keys","count","Number","Math","floor","e","target","checked","slice","filter","book","title","map","idx"],"mappings":"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","sourcesContent":["import React, {useState,useEffect} from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport BookCard from \"../components/BookCard.js\"\nimport Pagination from '@material-ui/lab/Pagination';\n\nimport Switch from '@material-ui/core/Switch';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Typography from '@material-ui/core/Typography';\n\n\n//  props will be a list of book objects\nexport default function ResultPage({results, searchTerms}) {\n\n      const [state, setState] = useState({\n          data : [],\n          searchTerms : [],\n          offset : 1,\n          perPageResults: 10,\n          sort: false\n\n        });\n\n        console.log(\"Result page rendered\")\n\n        \n        useEffect(() => {\n          const onRender = async () => {\n            console.log(\"Use effect hook\")\n            setState({...state, data:results, searchTerms : searchTerms}) \n            }\n          onRender()\n        },[]);\n\n\n        const handlePaginationClick = (offset) => {\n          setState({...state,offset:offset})\n        }\n\n        const handleSort = (value) => {\n          console.log(\"Sort\")\n          var arr = state.data\n          arr = sortByKey(arr,\"averageRating\")\n          setState({...state,sort:value,data:arr,sorting:false})\n          console.log(\"Sorted results\",state.data)\n        }\n\n        const sortByKey = (array, key) => {\n          return array.sort(function(a, b) {\n              var x = a[key]; \n              var y = b[key];\n              return ((x < y) ? 1 : ((x > y) ? -1 : 0));\n          });\n      }\n\n        // Calculate how many pagination page we will have \n        var length = Object.keys(state.data).length;\n        var count;\n        if (length % Number(state.perPageResults) == 0)\n          count = Math.floor(length/Number(state.perPageResults)) \n        else\n          count = Math.floor(length/Number(state.perPageResults)) + 1\n        console.log(\"Page count\",count)\n\n\n        return (\n        <Grid container \n        className=\"book-container\" \n        spacing={6}\n         justify=\"center\"   \n         alignItems=\"center\" \n         >\n           \n          <Grid \n            item \n            className=\"book-card-result\"\n            xs={8}\n          >\n\n            {length> 0 && ( \n            <Grid container spacing={3}>  \n            {length> state.perPageResults &&\n              <Grid item xs={8} >\n                  <Pagination \n                  count={count} \n                  page={state.offset} \n                  onChange={(e, offset) => handlePaginationClick(offset)} />\n              </Grid>\n              }\n\n              <Grid item xs={2} >\n                <FormControlLabel\n                control={<Switch checked={state.sort} onChange={e => handleSort(e.target.checked)} name=\"sort\" color=\"primary\"/>}\n                label=\"Average Rating\"\n                labelPlacement=\"End\"\n                />\n              </Grid>\n            </Grid>)}\n\n\n\n            { state.data.slice(\n             (state.offset -1 )*state.perPageResults, \n              (state.offset-1)*state.perPageResults + Number(state.perPageResults)).filter((book) => {\n                  return book.title != null;\n              }).map((book,idx) =>\n                  <BookCard  item key={idx} resultObj={book} searchTerms={state.searchTerms} />\n              )\n            }\n\n            {length> state.perPageResults &&\n             <Pagination \n             count={count} \n             page={state.offset} \n             onChange={(e, offset) => handlePaginationClick(offset)} />\n            }\n\n          </Grid>\n        </Grid> \n        \n        )\n};\n\n\n"]},"metadata":{},"sourceType":"module"}