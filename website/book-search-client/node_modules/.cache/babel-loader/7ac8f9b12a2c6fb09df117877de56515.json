{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import AppBar from'@material-ui/core/AppBar';import BookIcon from'@material-ui/icons/Book';import Grid from'@material-ui/core/Grid';import CssBaseline from'@material-ui/core/CssBaseline';import Toolbar from'@material-ui/core/Toolbar';import Typography from'@material-ui/core/Typography';import{makeStyles}from'@material-ui/core/styles';import Container from'@material-ui/core/Container';import CircularProgress from'@material-ui/core/CircularProgress';import ResultPage from\"./ResultPage.js\";import getSearchResults from\"../api/getSearchResults.js\";import SearchBar from\"../components/SearchBar.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{icon:{marginRight:theme.spacing(2)},cardGrid:{paddingTop:theme.spacing(8),paddingBottom:theme.spacing(8)},footer:{backgroundColor:theme.palette.background.paper,padding:theme.spacing(6)},margin:{margin:theme.spacing(1)},formControl:{margin:theme.spacing(1),minWidth:120}};});export default function SearchPage(){var classes=useStyles();var _useState=useState({apiResponse:{books:[]},searchTerms:[],isLoading:false,requestError:\"\",success:false}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];console.log(\"Search page render\");/* \nSingle handleRequest function that will trigger the proper API function based on the\ntype of search \n */var handleRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(searchInput){var quote,bookSearch,author,bookTitle,genre,yearFrom,yearTo,terms;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:quote=searchInput.quote,bookSearch=searchInput.bookSearch,author=searchInput.author,bookTitle=searchInput.bookTitle,genre=searchInput.genre,yearFrom=searchInput.yearFrom,yearTo=searchInput.yearTo;setState(_objectSpread(_objectSpread({},state),{},{isLoading:true,requestError:\"\",apiResponse:\"\"}));console.log(state.isLoading);terms=quote.split(\" \");_context.next=6;return getSearchResults(bookSearch?\"/books_from_terms_list\":\"/quotes_from_terms_list\",{terms:terms,author:author,bookTitle:bookTitle,genre:genre,yearFrom:yearFrom,yearTo:yearTo}).then(function(response){// console.log(\"res in setAPIResponse: \" + JSON.stringify(response));\nsetState(_objectSpread(_objectSpread({},state),{},{isLoading:false,apiResponse:{books:response.books},// book object, might contain quote as well \nrequestError:\"\",success:true,searchTerms:quote.split(\" \")}));}).catch(function(errorResponse){setState(_objectSpread(_objectSpread({},state),{},{isLoading:false,requestError:errorResponse,apiResponse:{quote:\"\"}}));});case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleRequest(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(SearchBar,{handleRequest:handleRequest}),/*#__PURE__*/_jsx(Container,{className:classes.cardGrid,maxWidth:\"md\",children:state.isLoading?/*#__PURE__*/_jsx(Grid,{container:true// spacing={6}\n,justify:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(CircularProgress,{})}):state.success&&/*#__PURE__*/_jsx(ResultPage,{results:state.apiResponse.books,searchTerms:state.searchTerms})// provide list of results\n})]}),/*#__PURE__*/_jsxs(\"footer\",{className:classes.footer,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",align:\"center\",gutterBottom:true,children:\"Footer\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",align:\"center\",color:\"textSecondary\",component:\"p\",children:\"Something here to give the footer a purpose!\"})]})]});}","map":{"version":3,"sources":["/Users/yussefsoudan/Studies/Uni/year-4-cs/TTDS/CW3/ttds-14/website/book-search-client/src/views/SearchPage.js"],"names":["React","useState","useEffect","AppBar","BookIcon","Grid","CssBaseline","Toolbar","Typography","makeStyles","Container","CircularProgress","ResultPage","getSearchResults","SearchBar","useStyles","theme","icon","marginRight","spacing","cardGrid","paddingTop","paddingBottom","footer","backgroundColor","palette","background","paper","padding","margin","formControl","minWidth","SearchPage","classes","apiResponse","books","searchTerms","isLoading","requestError","success","state","setState","console","log","handleRequest","searchInput","quote","bookSearch","author","bookTitle","genre","yearFrom","yearTo","terms","split","then","response","catch","errorResponse"],"mappings":"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","sourcesContent":["import React, {useState,useEffect} from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport BookIcon from '@material-ui/icons/Book';\nimport Grid from '@material-ui/core/Grid';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\n\nimport ResultPage from \"./ResultPage.js\"\nimport getSearchResults from \"../api/getSearchResults.js\";\nimport SearchBar from \"../components/SearchBar.js\";\n\n\nconst useStyles = makeStyles((theme) => ({\n  icon: {\n    marginRight: theme.spacing(2),\n  },\n  cardGrid: {\n    paddingTop: theme.spacing(8),\n    paddingBottom: theme.spacing(8),\n  },\n  footer: {\n    backgroundColor: theme.palette.background.paper,\n    padding: theme.spacing(6),\n  },\n  margin: {\n    margin: theme.spacing(1),\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  },\n\n}));\n\n\nexport default function SearchPage() {\n  const classes = useStyles();\n\n  const [state, setState] = useState({\n    apiResponse: {\n      books:[]\n    } , \n    searchTerms : [],\n    isLoading : false,\n    requestError:\"\",\n    success: false\n  });\n\n  console.log(\"Search page render\")\n\n/* \nSingle handleRequest function that will trigger the proper API function based on the\ntype of search \n */\n  const handleRequest = async (searchInput) => {\n\n    let {\n      quote, \n      bookSearch,\n      author ,\n      bookTitle,\n      genre,\n      yearFrom,\n      yearTo} = searchInput\n\n\n    setState({ ...state, isLoading: true, requestError: \"\", apiResponse: \"\" });\n    console.log(state.isLoading)\n    \n    let terms = quote.split(\" \") \n    \n    await getSearchResults(\n      bookSearch ? \"/books_from_terms_list\" : \"/quotes_from_terms_list\",\n\n      {terms, author ,bookTitle, genre, yearFrom, yearTo}\n      )\n        .then(response => {\n            // console.log(\"res in setAPIResponse: \" + JSON.stringify(response));\n            setState({\n                ...state,\n                isLoading: false,\n                apiResponse: {\n                  books : response.books}, // book object, might contain quote as well \n                requestError: \"\",\n                success:true,\n                searchTerms:quote.split(\" \")\n            });\n        })\n        .catch(errorResponse => {\n            setState({\n                ...state,\n                isLoading: false,\n                requestError: errorResponse,\n                apiResponse: {\n                  quote:\"\"\n                }\n            });\n        });        \n  }\n\n  return (\n    <React.Fragment>\n      <CssBaseline />\n      {/* <AppBar position=\"relative\">\n        <Toolbar>\n          <BookIcon className={classes.icon} />\n          <Typography variant=\"h6\" color=\"inherit\" noWrap>\n            Book Search Engine\n          </Typography>\n        </Toolbar>\n      </AppBar> */}\n      <main>\n        {/* Search bar including the Advance search options */}\n        <SearchBar handleRequest={handleRequest}/>\n\n        {/* Results container */}\n        <Container className={classes.cardGrid} maxWidth=\"md\">\n          {/* Container to hold the results of the search  */}\n          {state.isLoading\n          ? ( <Grid container \n            // spacing={6}\n             justify=\"center\"   \n             alignItems=\"center\" \n             >\n            <CircularProgress />\n          </Grid>) \n          :  ( state.success && <ResultPage results={state.apiResponse.books} searchTerms={state.searchTerms} /> ) // provide list of results\n          }\n        </Container>\n      </main>\n\n      {/* Footer */}\n      <footer className={classes.footer}>\n        <Typography variant=\"h6\" align=\"center\" gutterBottom>\n          Footer\n        </Typography>\n        <Typography variant=\"subtitle1\" align=\"center\" color=\"textSecondary\" component=\"p\">\n          Something here to give the footer a purpose!\n        </Typography>\n      </footer>\n      {/* End footer */}\n    </React.Fragment>\n  );\n}"]},"metadata":{},"sourceType":"module"}